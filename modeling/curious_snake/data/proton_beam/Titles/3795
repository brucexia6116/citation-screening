Differential-pencil-beam dose calculations for charged particles