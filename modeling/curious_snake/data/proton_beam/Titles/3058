A pencil beam algorithm for proton dose calculations