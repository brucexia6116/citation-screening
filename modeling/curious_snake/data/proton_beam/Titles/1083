Inverse planning of intensity modulated proton therapy