Numerical calculation of energy deposition by high-energy electron beams: III. Three-dimensional heterogeneous media