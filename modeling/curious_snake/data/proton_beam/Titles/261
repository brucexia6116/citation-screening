A respiratory-gated treatment system for proton therapy