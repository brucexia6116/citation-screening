Compensating for heterogeneities in proton radiation therapy