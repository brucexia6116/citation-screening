Extension of a numerical algorithm to proton dose calculations. I. Comparisons with Monte Carlo simulations