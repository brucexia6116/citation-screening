dose optimization proton heavy ion therapy using generalized sampled pattern matching