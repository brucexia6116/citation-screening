simulations design online motion compensation scanned particle beams