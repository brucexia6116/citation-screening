Dose optimization with computer-controlled gantry rotation, collimator motion and dose-rate variation