Optimization for fast-scanning irradiation in particle therapy