A pencil beam algorithm for intensity modulated proton therapy derived from Monte Carlo simulations