A Monte Carlo dose calculation algorithm for proton therapy