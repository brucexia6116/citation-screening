An in-beam dual-head positron camera is used to monitor the dose application in situ during the tumour irradiation with carbon ion beams at the experimental heavy ion therapy facility at GSI Darmstadt. Therefore, a positron emission tomograph has been mounted directly at the treatment site. A fully 3D reconstruction algorithm based on the maximum likelihood expectation maximization (MLEM) algorithm has been developed and adapted to this spatially varying imaging situation. The scatter and attenuation correction are included in the forward projection step of the maximum likelihood image reconstruction. This requires an attenuation map containing the information on the material composition and densities. This information is derived from the x-ray computed tomograms of the patient and the patient fixation system including the head-rest. The normalization of scattered events relative to the unscattered events is done by a global scatter fraction factor which is estimated by means of a Monte Carlo simulation. The feasibility of the proposed algorithm is shown by means of computer simulations, phantom measurements as well as patient data