We have upgraded a heavy-ion radiotherapy treatment-planning system to adapt for the layer-stacking irradiation method, which is to conform a variable spread-out Bragg peak to a target volume by means of dynamic control of the conventional beam-modifying devices. The biophysical model, the beam-setup logic, and the dose-calculation algorithm implemented for the layer-stacking method are described and the expected clinical usability is discussed. The layer-stacking method was integrated in perfect accordance with the ongoing conventional treatments so that the established protocols, which are the clinically optimized dose fractionation schemes, will still be valid. On the other hand, a simulation study indicated a substantial improvement of dose distribution with the layer-stacking method though the significance may depend on the size, shape, and location of the tumor. The completed treatment system will provide an option for improved conformal radiotherapy without interfering with the conventional method and we expect a gradual expansion of the clinical cases applicable to the layer-stacking method