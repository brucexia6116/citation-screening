PURPOSE: The purpose of this article is to evaluate a pencil-beam dose calculation algorithm for protons and heavier charged particles in complex patient geometries defined by computed tomography (CT) data and to compare isodose distributions calculated with the new technique to those calculated with conventional algorithms in selected patients with skull-base tumors. METHODS AND MATERIALS: Monte Carlo calculations were performed to evaluate the pencil-beam algorithm in patient geometries for a modulated 150-MeV proton beam. A modified version of a Monte Carlo code described in a previous publication (18) was used for these comparisons. Tissue densities were inferred from patient CT data on a voxel-by-voxel basis, and calculations were performed with and without tissue compensators. A dose calculation module using the new algorithm was written, and treatment plans using the new algorithm were compared to plans using standard ray-tracing techniques for 10 patients with clival chordoma and three patients with nasopharyngeal carcinoma who were treated with helium lons at Lawrence Berkeley National Laboratory (LBL). RESULTS: Pencil beam calculations agreed well with Monte Carlo calculations in the patient geometries. The pencil-beam algorithm predicted several multiple-scattering effects that are not modeled by conventional ray-tracing calculations. These include (a) the widening of the penumbra as a function of beam penetration, (b) the degradation in the sharpness of the dose gradient at the end of the particle range in highly heterogeneous regions, and (c) the appearance of hot and cold dose regions in the shadow of complex heterogeneities. In particular, pencil-beam calculations indicated that the dose distribution within the target was not as homogeneous as expected on the basis of ray-tracing calculations. On average, for the 13 patients considered, only about 72% of the conedown target volume received at least 99% of the prescribed dose, whereas, 93% of the conedown volume was contained within the 95% isodose surface. This may be significant because in standard charged particle dose calculations, the dose across the spread-Bragg peak is assumed to be uniform and equal to the maximum or prescribed dose. CONCLUSIONS: Dose distributions computed with the pencil-beam model are more accurate than ray-tracing calculations, providing additional information to clinicians, which may influence the doses they prescribe. In particular, these calculations indicate that for some patients with skull-base tumors, it may be advantageous to prescribe proton doses to a lower isodose level than is commonly done