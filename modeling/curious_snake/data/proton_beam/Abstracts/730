A method is described for calculating the output from conformally shaped megavoltage X-ray beams. The model has been developed for Varian accelerators but is shown to work for accelerators from another manufacturer. The use of dynamic wedging and both static and dynamic multileaf collimated beams are included in the model. For any linear accelerator, the data required are a set of measured output factors for square beams, an in-air profile and a limited number of readily available parameters defining the geometry of the head of the accelerator. The three components of the output, namely primary, head scatter and phantom scatter are modelled and calculated individually for any point in a beam. An optimization procedure is developed that automatically determines the eight parameters required to model an accelerator in order for these calculations to be performed. The performance of the method is demonstrated for shaped beams using asymmetric and multileaf collimation, both with and without wedging, and for a range of beam energies. The model has been incorporated into a computer program that is used clinically