A Monte Carlo (MC) code (VMCpro) for treatment planning in proton beam therapy of cancer is introduced. It is based on ideas of the Voxel Monte Carlo algorithm for photons and electrons and is applicable to human tissue for clinical proton energies. In the present paper the implementation of electromagnetic and nuclear interactions is described. They are modeled by a Class II condensed history algorithm with continuous energy loss, ionization, multiple scattering, range straggling, delta-electron transport, nuclear elastic proton nucleus scattering and inelastic proton nucleus reactions. VMCpro is faster than the general purpose MC codes FLUKA by a factor of 13 and GEANT4 by a factor of 35 for simulations in a phantom with inhomogeneities. For dose calculations in patients the speed improvement is larger, because VMCpro has only a weak dependency on the heterogeneity of the calculation grid. Dose distributions produced with VMCpro are in agreement with GEANT4 results. Integrated or broad beam depth dose curves show maximum deviations not larger than 1% or 0.5 mm in regions with large dose gradients for the examples presented here