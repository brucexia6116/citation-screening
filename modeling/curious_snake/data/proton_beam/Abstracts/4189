All current optimization techniques in radiation therapy benefit from the use of strongly non-uniform radiation beams. The most flexible way of generating these fields under real time control is by elementary beam scanning and/or dynamic multileaf collimation. In this work general analytical expressions are derived for the required motion of the collimator leaves to achieve a desired energy fluence distribution or collimator opening density in the patient in the shortest possible time. By simplification of the general expressions the equations of motion have been derived for both the shrinking field and the curtain shutter techniques with the associated approximations clearly quantified. The mechanical limitations on leaf motion, caused by the finite velocity and acceleration, are taken into account. It is shown that almost any desired energy fluence distribution can be created even when the limitations on velocity and acceleration are considered. The basic rule with the curtain shutter technique is that when the energy fluence gradient along the direction of motion of the leaves is positive, the leading leaf should move at maximum speed and the lagging leaf should modulate the field. In regions where the gradient is negative the lagging leaf should instead move at full speed and the leading leaf should modulate the field. The overall treatment time is then proportional to the total increment in energy fluence or opening density between consecutive minima and maxima. For energy fluence profiles with numerous high peaks the treatment time may therefore increase considerably over that for conventional uniform dose delivery. However, in general the treatment time is prolonged by a factor of about two compared to a traditional uniform treatment. Obviously the method developed here for multileaf collimators is also suitable for simple block collimators since it can be used to deliver arbitrary regular or irregular 'dynamic wedge' profiles along the direction of motion of the collimator blocks