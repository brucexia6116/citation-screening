tumors highly complex shapes patching strategy used passively scattered proton therapy match sharp distal edge bragg peak sobp patch field lateral penumbra field NUMBER dose level differences dose gradients distal edge lateral penumbra cause hot cold doses junction note algorithm developed optimize range compensator design yield uniform dose distribution junction algorithm based fact distal sobp tailored using grid filter placed perpendicular beams path filter optimized distal patch field complements lateral penumbra field addition optimizing optimization process implicitly accounts limitations conventional compensator design algorithms algorithm uses simple ray tracing determine compensator shape ignore scatter compensated dose distribution differ substantially intended dose distribution especially complex heterogeneities encountered head neck case adaptive optimization strategy used optimize grid filter locally considering tissue heterogeneities grid filter obtained superimposed original range compensator composite compensator leads uniform dose distribution patch junction head neck tumor used demonstrate validity proposed algorithm robustness analysis focus range uncertainty effect carried spread fall fall fall fall l shaped