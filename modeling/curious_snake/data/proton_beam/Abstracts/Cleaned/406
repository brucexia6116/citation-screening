simple analytical model predicts exact proton spectrum needed obtain peak sobp distribution proton beams theory based solution boltzmann kinetic equation proton distribution function resulting analytical expression allows calculate sobp proton energy spectra different beamlet sizes modulation depths readily implemented calculation energy intensity modulated proton dose distributions practical implementation energy modulation proton beams realized discrete superposition individual bragg peaks shown exists optimal relationship energy sampling size width initial proton energy distribution spread bragg laser accelerated