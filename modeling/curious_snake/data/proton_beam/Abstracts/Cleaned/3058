sharp lateral penumbra rapid dose end range proton beam major advantages proton radiation therapy beam characteristics depend position characteristics upstream devices apertures compensating boluses extent separation devices patient particularly critical respect developed pencil beam algorithm proton dose calculations takes accurate account effects materials upstream patient air gap patient model includes new approach picking locations pencil beams accurately model penumbra effectively account effects media point present faster version algorithm gives reasonably accurate penumbra predictions algorithm results experiments performed proton beam presented general algorithm agrees measurements fall beam modifying beam modifying multiple scattering broad beam large field