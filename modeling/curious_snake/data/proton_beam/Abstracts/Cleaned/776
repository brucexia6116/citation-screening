density heterogeneities profound effect dose distributions proton therapy analytical calculations homogeneous media relatively straightforward modelling propagation beam density heterogeneities problematical paul scherrer institute dedicated monte carlo mc code used decade assess possible deficiencies analytical calculations patient geometries mc code optimized speed traces primary protons treatment nozzle patients ct contributions nuclear interactions modelled analytically tracing secondary particles mc code verified measured data water experimental proton radiographs heterogeneous anthropomorphic phantom comparison analytical calculation mc code applied spot scanned intensity modulated proton therapy plans number cases containing titanium metal implants summary dose calculations provide invaluable tool independently verifying calculated dose distribution patient geometry comprehensive quality assurance protocol proton treatment plans house mc based