particle algorithm developed proton beam dose calculation radiotherapy monoenergetic protons NUMBER mev kinetic energy simulated infinite water phantom using geant3 monte carlo code changes location angle energy transport step energy deposition track recorded primary protons secondary particles calculating dose patient realistic proton beam particle tracks repeated patient geometry consisting air soft tissue bone medium density dose scoring voxel patient geometry derived patient ct data starting point proton track repeated determined according incident proton energy protons kinetic energy NUMBER mev simulated based direction incident proton tracks rotated subsequent steps scattering angles simply repeated air soft tissue adjusted properly based scattering power bone particle step lengths adjusted based density air soft tissue stopping powers bone keeping energy deposition unchanged step difference nuclear interactions secondary particle generation water materials ignored algorithm validated comparing dose distributions uniform water layered heterogeneous phantoms calculated using geant3 code NUMBER NUMBER NUMBER NUMBER mev proton beams differences NUMBER new algorithm NUMBER times faster geant3 monte carlo code uniform phantom geometry NUMBER times faster heterogeneous phantom geometry track repeating pre generated