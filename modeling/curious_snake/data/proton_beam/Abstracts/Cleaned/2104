gantry proton radiotherapy paul scherrer institute psi designed specifically technique use technique potential requires dose calculation algorithms capable precisely simulating scanned beam individually different specialized analytical dose calculations developed attempt model effects density heterogeneities patients body dose accuracy evaluated comparison monte carlo calculated dose distributions case simple geometrical density interface parallel beam typical anatomical situations specialized ray casting model takes range dilution effects broadening spectrum proton ranges account produce results good accuracy algorithm easily implemented iterative optimization procedure used calculation optimal contribution individual scanned pencil beam cases elemental pencil beam dose calculation accurate long computing time model currently used optimization procedure alternative method calculating dose spot scanning