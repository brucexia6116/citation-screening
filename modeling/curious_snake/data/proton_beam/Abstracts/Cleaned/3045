photon beam convolution calculations polyenergetic energy deposition kernels edks used primary photon energy spectrum correctly accounted monte carlo generation edks requires probability interaction determined linear attenuation coefficient mu taken account primary photon interactions forced occur edk origin use primary scattered edks generated fixed photon spectrum rise error dose calculation neglecting effects beam hardening depth proportion primary photon energy transferred secondary electrons increases depth interaction increase ratio mu beam hardens convolution curves calculated using polyenergetic edks generated primary photon spectra exist depths NUMBER NUMBER NUMBER cm water steep compared egs4 monte carlo results beam hardening correction factor applied primary scattered NUMBER cm edks based ratio kerma terma depth gives primary scattered total dose good agreement monte carlo results depth dose fall ab mu