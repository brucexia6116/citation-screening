monte carlo mc code vmcpro treatment planning proton beam therapy cancer introduced based ideas voxel monte carlo algorithm photons electrons applicable human tissue clinical proton energies present paper implementation electromagnetic nuclear interactions described modeled class ii condensed history algorithm continuous energy loss ionization multiple scattering range straggling transport nuclear elastic proton nucleus scattering inelastic proton nucleus reactions vmcpro faster general purpose mc codes fluka factor NUMBER geant4 factor NUMBER simulations phantom inhomogeneities dose calculations patients speed improvement larger vmcpro weak dependency heterogeneity calculation grid dose distributions produced vmcpro agreement geant4 results integrated broad beam depth dose curves maximum deviations larger NUMBER NUMBER mm regions large dose gradients examples presented delta electron