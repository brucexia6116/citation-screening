photon beam convolution distribution energy deposition primary photon interaction site charged particles set motion site represented primary kernel energy deposited scattered photons bremsstrahlung annihilation photons represented scatter kernel energy deposited kernel voxel normalized energy imparted interaction site known fractional energy distribution convolution kernels normalized total energy imparted interaction site convolved terma dose calculation process sum fractional energies contained primary kernel equal ratio collision kerma kc terma t corresponding energy spectrum used generate kernel ratio collision kerma terma increases depth beam hardens integral fractional energy primary kernel formed spectrum surface ratio depth causes primary dose increasingly underestimated depth scatter dose increasingly overestimated single polyenergetic convolution using polyenergetic primary scatter kernels formed using polyenergetic primary photon spectrum rigorous separate convolution performed energy component ratio true primary dose single polyenergetic primary dose increases linearly depth equal ratio primary scatter dose calculated correctly single polyenergetic convolution performed terms kc primary scatter kernels weighted sums monoenergetic kernels normalized kc method ensured total primary energy deposited primary photon interactions unit mass point equal kc point terma based t kc t kc kc t kc t